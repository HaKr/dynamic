<!DOCTYPE html>
<html>
	<head>
		<title>Dynamic App</title>
		<link rel="stylesheet" media="all" href="dynamic-app.css">
		<script src="cms-generic.js"></script>
		<script src="dynamic-scopes.js"></script>
		<script src="dynamic-values.js"></script>
		<script src="dynamic-app.js"></script>
	</head>

	<body>

		<dfn class="dynamic-value form-layouts hash">
				<var title="A">one</var>
				<var title="B">two</var>
				<var title="C">three</var>
				<var title="D">four</var>
			</dfn>
		<dfn class="dynamic-value year number">2016</dfn>
		<dfn class="dynamic-value formname string">C</dfn>
		<dfn class="dynamic-value formlayout string" data-dynamic-value-depends-on="formname" data-dynamic-value-collection="form-layouts">three</dfn>
		<dfn class="dynamic-value available-years list" data-dynamic-value-url="/displaygroup/available_years"></dfn>
		<dfn class="dynamic-value available-forms list" data-dynamic-value-url="/displaygroup/available_forms"></dfn>
		<dfn class="dynamic-value statementsets list" data-dynamic-value-url="/displaygroup/available_statementsets/{{year}}"></dfn>
		<dfn class="dynamic-value displaygroups list" data-dynamic-value-url='/displaygroup?where={"form_name": "{{Formname}}","valid_from":{"<":"01-JUN-{{year}}"},"valid_until":{">":"01-JUN-{{year}}"}}'>
			</dfn>


		<p class="jjdk dynamic-template no-data">Please select a year and a form name.</p>


		<p class="dynamic-template no-groups">No form definition {{Formname}} for {{Year}}</p>


		<select name="{{displaygroupset.dynamic_node_name}}[statement_code]" class="statement_code dynamic-template statement-set-select" data-dynamic-value="{{displaygroupset.set_reference}}" data-dynamic-template-for="statementsets">
					<option disabled="" selected="" value="-1">Please select a statement set label.</option>


						<option value="{{statementset.shortname}}" class="dynamic-template statementset-option" data-dynamic-template-for-each="statementsets">{{statementset.shortname}}</option>

				</select>


		<span class="dynamic-template grp-buttons" data-dynamic-template-for="displaygroups.allow-modifications">
					<button type="button" class="btn btn-primary add-set" title="add a new statement">+</button>
					<button type="button" class="btn btn-info remove-group" title="remove the whole group">-</button>
				</span>


		<span class="dynamic-template set-buttons" data-dynamic-template-for="displaygroups.allow-modifications">
					<button type="button" class="btn btn-primary remove-set" title="remove this statement">-</button>
				</span>


		<span class="dynamic-template tbl-buttons" data-dynamic-template-for="displaygroups.allow-modifications">
							<button type="button" class="btn btn-info add-group" title="add a new Group">+</button>
				</span>


		<div class="dynamic-scope nav">
			<dfn class="dynamic-value nav_1 string">nav 1</dfn>
			<div class="mambo">
				<dfn class="dynamic-value nav_2 string">nav 2</dfn>
				<div class="dynamic-scope navnav">
					<dfn class="dynamic-value nav_1_1 string">nav 1 navnav 1</dfn>
					<dfn class="dynamic-value level number">10011</dfn>
				</div>
			</div>
		</div>


		<div id="dynamic" class="row">
			<div class="col-md-9 layout">
				<h2>Display groups</h2>
				<h3>Level: {{nav.navnav.level}}</h3>
				
				<form id="build_input" method="post" enctype="multipart/form-data">

					<div id="selection">
						<label for="formname-select">Form name: </label>
						<select id="formname-select" name="formname-select" data-bind="formname">
								<option disabled="" selected="" value="-1">Please select a Form name.</option>

									<option value="{{available_form.form_name}}" class="dynamic-template formname-option" data-dynamic-template-for-each="available_forms">{{available_form.form_name}}</option>

							</select>

						<label for="year-select">Year:    </label>
						<select id="year-select" name="year-select" data-bind="year">
								<option disabled="" selected="" value="-1">Please select a period.</option>

									<option value="{{available_year.year}}" class="dynamic-template year-option" data-dynamic-template-for-each="available_years">{{available_year.year}}</option>

							</select>
					</div>

					<div class="displaygroups" lang="de">

						<p class="dynamic-template layout-name" data-dynamic-template-for="formlayout">Layout: {{formlayout}}</p>


						<div class="group-table dynamic-template grouptable" data-dynamic-template-for="displaygroups" data-dynamic-template-options="on-empty=no-groups;alternative=no-data">
							<table id="datenErfassungTable" class="inputAreaDarkWide jahresmeldung">
							  <thead>
							    <tr id="header1">
							      
							      <th colspan="2">Datenerfassung LVA</th>                 
							      <th colspan="2">
							        <table>
							          <tbody>
							            <tr>
							              <th>Validity</th>
							              <td>
							                <input type="text" name="displaygroup[valid-from]"  value="{{displaygroups.valid_from}}" class="valid-from  format-numerical">
							                <input type="text" name="displaygroup[valid-until]" value="{{displaygroups.valid_until}}" class="valid-until format-numerical">
							                <span data-dynamic-template-ref="tbl-buttons"></span>
							              </td>
							            </tr>
							          </tbody>
							        </table>

							      </th>         
							    </tr>
							  </thead>
							    
							  <tfoot>
							    <tr class="displayGroupSeparatorRow">
							      <td colspan="4">&nbsp;</td>
							    </tr>
							    <tr class="displayGroupRow">
							      <td colspan="4">Gesamte Liefermenge</td>
							    </tr>
							    <tr>              
							      <td class="indentor">&nbsp;</td>
							      <td class="set-label">&nbsp;</td>
							      <td class="set-data" colspan="2">
							        <table>
							          <tbody>
							            <tr>
							              <th>Strommenge [kWh]</th>
							              <td class="quantity" >Sum(css='.quantity.do-add')</td>
							            </tr>
							            <tr>
							              <th>EEG-Umlage [€]</th>
							              <td class="surcharge" >Sum(css='.surcharge.do-add')</td>
							            </tr>
							          </tbody>
							        </table>
							      </td>
							    </tr>
							      
							  </tfoot>      

							  <tbody data-dynamic-template="grouplabel;for-each=displaygroups" class="statementGroup">
							    <tr class="displayGroupSeparatorRow">
							      <td colspan="4">&nbsp;</td>
							    </tr>
							    <tr class="displayGroupRow">
							      <td colspan="3"><textarea class="html_label group" name="{{displaygroup.dynamic_node_name}}[label]">
							      {{displaygroup.group_label}}
							      </textarea>
							      </td>
							      <td>
							      <span data-dynamic-template-ref="grp-buttons"></span>
							    </tr>
							  </tbody>
							  <tbody data-dynamic-template="grouplabel" class="statementData" >
							    <tr data-dynamic-template="setlabel;for-each=displaygroup.displaygroupsets" class="statementRow {{displaygroupset.set_reference}}" >
							      <td class="indentor"><span data-dynamic-template-ref="set-buttons"></span></td>
							      <td class="set-label"><textarea class="html_label set" name="{{displaygroupset.dynamic_node_name}}[label]">{{displaygroupset.set_label}}</textarea></td>
							      <td class="set-data">
							        <table>
							          <tbody>
							            <tr>
							              <th>Strommenge [kWh]</th>
							              <td>
							                <input type="text" name="{{displaygroupset.dynamic_node_name}}[quantity]" class="quantity {{displaygroupset.css_class}} formatted format-numerical" value="{{displaygroupset.display_quantity}}">
							              </td>
							            </tr>
							            <tr>
							              <th>EEG-Umlage [€]</th>
							              <td>
							                <input type="text" name="{{displaygroupset.dynamic_node_name}}[surcharge]" class="surcharge {{displaygroupset.css_class}} formatted format-numerical" value="{{displaygroupset.display_surcharge}}">
							              </td>
							            </tr>
							          </tbody>
							        </table>
							      </td>
							      <td class="set-meta">
							        <table>
							          <tbody>
							            <tr>
							              <th>CSS class</th>
							              <td>
							                <input type="text" name="{{displaygroupset.dynamic_node_name}}[css_class]" class="css-class" value="{{displaygroupset.css_class}}">
							              </td>
							            </tr>
							            <tr>
							              <th>Statement</th>
							              <td>
							                <select data-dynamic-template-ref="statement-set-select"></select> 
							              </td>
							            </tr>
							          </tbody>
							        </table>
							      </td>
							    </tr>
							  </tbody>

							</table>
						</div>

					</div>
				</form>
			</div>

			<div class="col-md-3 sets">

				<h3 class="dynamic-template grouptable" data-dynamic-template-for="displaygroups" data-dynamic-template-options="on-empty=no-groups;alternative=no-data">Statement sets for {{Year}}</h3>


				<div class="dynamic-template statement-set-list" data-dynamic-template-for="statementsets" data-dynamic-template-options="on-empty=no-statement-set-list;alternative=no-statement-set-list">
					<ul>

						<li class="dynamic-template statement-set-detail-outer" data-dynamic-template-for-each="statementsets">
							{{statementset.shortname}}
							<ul>

								<li title="{{statement.designation}}" class="dynamic-template statement-set-detail_inner" data-dynamic-template-for-each="statementset.statements">* {{statement.shortname}}</li>

							</ul>
						</li>

					</ul>
				</div>

			</div>
		</div>

		<div class="dynamic-scope nav">
			<div class="dynamic-scope navnav2">
				<dfn class="dynamic-value nav_2_1 string">nav 1 navnav2 1</dfn>
			</div>
		</div>

		<div id="editor-popup" class="modalbox hidden">
			<div class="html_editor">
				<textarea></textarea> <button id="cancel_html" type="reset">Cancel</button><button type="submit" id="save_html">OK</button>
			</div>
		</div>


		<div class="dynamic-scope navi">
			<dfn class="dynamic-value nav_1 string">nav_1</dfn>
			<div class="mambo">
				<dfn class="dynamic-value nav_2 string">Nav 2</dfn>
				<dfn class="dynamic-value nav_3 number">Nav #3</dfn>
				<div class="dynamic-scope nav-nav">
					<dfn class="dynamic-value nav-nav-1 string">Nav 1 Nav nav 1</dfn>
				</div>
			</div>
		</div>
	</body>
</html>