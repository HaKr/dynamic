<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>Dynamic App</title>

		
		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Raleway:200,200i,300,300i,400,400i,500,500i" media="all">
		<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Montserrat:400,700" media="all">
		<link rel="stylesheet" href="css/font-awesome.min.css" />
		<link rel="stylesheet" href="css/main.css" />
		<link rel="stylesheet" href="css/header.css" />
		<link rel="stylesheet" href="css/footer.css" />
		<link rel="stylesheet" href="css/forms.css" />
		<link rel="stylesheet" href="css/tables.css" />
		<link rel="stylesheet" href="css/mobile.css" />

		<link rel=stylesheet media=all href=css/dynamic-app.css>

		<script src=js/dynamic-app.js></script>
		<script src=js/dynamic-person.js></script>
	</head>

	<body class="dynamic-person container">
		<header id="header">
			<nav id="menu" class="menu">
				<div id="logo" class="logo">
					<a href="/"><img src="images/logo.png" alt="Ciber logo" /></a>
					<h1>Dynamic App</h1>
				</div>
			</nav>
		</header>

		<!-- some common templates -->
		<div class="helpTextContainer dynamic-template help-text">
			<a class=""><i class="fa fa-question-circle-o"></i></a>
			<div class="replace argument helpText"></div>
		</div>

		<label class="nested dynamic-template labeled-item">
			<span class="argument reallabel"></span> 
			<span class="replace argument data-item"></span>
		</label>

		<fieldset class="dynamic-template input-with-help">
			<label class="nested">
				<span class="argument reallabel"></span> 
				<input class="replace argument input">
			</label>
			<div class="dynamic-template help-text" data-dynamic-template-options="with-content"></div>
		</fieldset>

			<!-- Template that will be used in the table -->
			<select class="dynamic-template fte-select">
				<option value="" class=placeholder>Choose the number of contract hours per week.</option>
				<option value={{fte.fulltime}}>Fulltime</option>
				<option value={{fte.36}}>36 uur</option>
				<option value={{fte.32}}>32 uur</option>
				<option value={{fte.24}}>24 uur</option>
				<option value={{fte.20}}>20 uur</option>
				<option value={{fte.16}}>16 uur</option>
				<!-- alternative way to specify a fixed value  -->
				<option value='{{fte.8= 8 / 40}}'>8 uur</option>
			</select>


		<!-- end common templates -->

		<main>
		
			<form class=selection action="javascript:;">

				<!-- Simulator buttons, one simulates the GET of person data, the second logs that data to the console -->
				<fieldset>
					<label>Actions</label
					><button type="button" id=set-button>Simulate Get Person list call</button
					><button type="button" id=show-button>Show person in console</button>
				</fieldset>

				<fieldset class="dynamic-template input-with-help person-select" data-dynamic-template-with-content data-dynamic-template-for="persons">
					<label class="parameter reallabel">Show info for</label>
					<select class="person-select parameter input" name=.$selected>
						<option class="placeholder" value="">Choose a person</option>

						<option value={{.$reference}} class="dynamic-template person-select-option" data-dynamic-template-for-each="persons">
							{{.first-name}} {{.last-name}}
						</option>

					</select>
					<p class="parameter helpText">Select a name from this list and its details will appear below
				</fieldset>
				
			</form>

			<div class="dynamic-template please-select">
				<p>Please click on the Simulate button above...
			</div>

			<div class="dynamic-template persons-retrieved" data-dynamic-template-for="persons" data-dynamic-template-options="on-empty=please-select">

				<!-- company info; company address will be added later in this HTML -->
				<div class="dynamic-template company" data-dynamic-template-for="persons.@.company" title="{{.title}}">
					<h2>{{.name}}</h2>
				</div>

				<form id="build_input" method="post" action="/api/build-input" class="dynamic-template person-record-input selected" data-dynamic-template-for="persons.@">
					<fieldset>

						<fieldset class="dynamic-template input-with-help" data-dynamic-template-with-content>
							<label class="parameter reallabel">First name</label>
							<input class="parameter input" name=.first-name>
							<div class="parameter helpText" >
								<p>Enter <i class="fa fa-pencil"></i> the <b>first name</b> of the selected person.
								<p>Observe how this name is copied all over this page.
							</div>
						</fieldset>


						<fieldset class="dynamic-template input-with-help" data-dynamic-template-with-content>
							<label class="parameter reallabel">Last name</label>
							<input class="parameter input" name=.last-name>
							<div class="parameter helpText" >
								Enter <i class="fa fa-pencil"></i> the <b>family name</b> of the selected person.
							</div>
						</fieldset>

						<div class="dynamic-template person-input-has-company" data-dynamic-template-for=persons.@.company>
							<fieldset class="dynamic-template input-with-help" data-dynamic-template-with-content>
								<label class="parameter reallabel">Salary</label>
								<select class="parameter input" name=.salary_month>
									<option value="" class=placeholder>Choose a monthly reimbursement for a FTE</option>
									<option value=0>None</option>
									<option value=1631>Minimum</option>
									<option value=2000>Junior</option>
									<option value=3000>Medior</option>
									<option value=4000>Senior</option>
									<option value=5000>Principal</option>
								</select>
								<p class="parameter helpText">Select what reimbursement {{.last-name}} gets for this job.
							</fieldset>

							<fieldset class="dynamic-template input-with-help" data-dynamic-template-with-content>
								<label class="parameter reallabel">FTE</label>
								<select name=.fte class="dynamic-template fte-select parameter input" data-dynamic-template-for='.id'></select>
								<p class="parameter helpText">Select what percentage of 40 hours {{.last-name}} is working.
							</fieldset>
						</div>

					</fieldset>
				</form>

				<!--
					Generic address template 
						Only when the street is given, street and number are added
						Note that when postal is missing, no blanks are left of city
				-->
				<address class="dynamic-template address">
					<i class="fa fa-envelope-o"></i>
					<label class="dynamic-template labeled-item" data-dynamic-template-with-content data-dynamic-template-for=".street">
						<span class="parameter reallabel">Address</span> 
						<span class="parameter data-item">{{.street}} {{.number}}</span>
					</label>
					<label class="dynamic-template labeled-item" data-dynamic-template-with-content>
						<span class="parameter reallabel">City</span> 
						<span class="parameter data-item">{{.postal}}  {{.city}}</span>
					</label>
				</address>

				<div title="{{.last-name}}, {{.first-name}}" class="dynamic-template person-record selected" data-dynamic-template-for="persons.@">
					<input type=hidden name=.id>
					<label class="dynamic-template labeled-item" data-dynamic-template-with-content>
						<span class="parameter reallabel">First name</span> 
						<span class="parameter data-item">{{.first-name}}</span>
					</label>
					<label class="dynamic-template labeled-item" data-dynamic-template-with-content>
						<span class="parameter reallabel">Last name</span> 
						<span class="parameter data-item">{{.last-name}}</span>
					</label>

					<!-- value based templates -->
					<label class="dynamic-template labeled-item" data-dynamic-template-with-content data-dynamic-template-for=persons.@.company>
						<span class="parameter reallabel">Annual salary</span> 
						<span class="parameter data-item">
							<span class='dynamic-template fte-explain' data-dynamic-template-for=.fte data-dynamic-template-options="range=[0,1]">
							(
							<span class='dynamic-template fte-fulltime-text-full' data-dynamic-template-for=.fte data-dynamic-template-options="range=[0.9,1]">fulltime,</span>
							<span class='dynamic-template fte-fulltime-text-part' data-dynamic-template-for=.fte data-dynamic-template-options="range=[0.25,0.9>">parttime,</span>
							<span class='dynamic-template fte-fulltime-text-other' data-dynamic-template-for=.fte data-dynamic-template-options="range=[0,0.25>">freelance,</span>
							<span class='dynamic-template fte-fulltime' data-dynamic-template-for=.fte><input readonly class=percentage name="..fte"></span>
							)
							€ <input readonly class=currency-int type=number name=.per_annum>							
							</span>
						</span>
					</label>

					<address class="dynamic-template address" data-dynamic-template-for="persons.@.address"></address>
				</div>

				<!-- addition to the company template above, only the children of this DIV are added -->
				<div class="dynamic-template company" data-dynamic-template-options="only-content">
					<address class="dynamic-template address" data-dynamic-template-for=".address"></address>
				</div>

				<table class="dynamic-template person-grid" data-dynamic-template-for="persons">
					<thead>
						<tr>
							<th>id <th>Last <th>First <th>City <i class="fa fa-sort-alpha-asc"></i><th>Salary base and FTE <th>Monthly salary <th>Annual salary<th>Notes <i class="fa fa-sort-alpha-asc"></i><th>
						</tr>
					<tbody>
						<tr class="dynamic-template person-grid-row" data-dynamic-template-for-each="persons" data-dynamic-template-options="sort=address.city,description">
							<td class=person-id>{{.id}}
							<td>{{.last-name}}
							<td>{{.first-name}}
							<td>{{.address.city}}
							<td>
								<span class="dynamic-template person-has-company" data-dynamic-template-for=.company>
									<input name=".salary_month" step=25 class="salary" type=number min=0>
									<select name=.fte class="dynamic-template fte-select" data-dynamic-template-with-content></select>
								</span>
							<td><input readonly class="currency dynamic-template person-has-company-salary" data-dynamic-template-for=.company type=number name=".salary= .salary_month * .fte">
							<td><input readonly class="currency dynamic-template person-has-company-annual" data-dynamic-template-for=.company type=number name=".per_annum= .salary * 12 * 1.08">
							<td>{{.description}}
							<td><button class="fa fa-times             remove    dynamic-value" title="remove {{.first-name}} {{.last-name}}."></button>
						</tr>
					<tfoot>
						<tr>
							<td colspan=2>Totals
							<td colspan=2>{{persons.$count}} rows
							<td colspan=1>
							<td><input readonly class=currency type=number name="totals.salary= 	Sum(persons.*.company.salary)">
							<td><input readonly class=currency type=number name="totals.per_annum= Sum(persons.*.company.per_annum)">
							<td colspan=2>
						</tr>
				</table>

				<div class=person-tiles>
					<div  class="dynamic-template person-tile" data-dynamic-template-for-each="persons" >
						{{.id}}	{{.last-name}}, {{first-name}}	{{.address.city}}
							<button class="fa fa-times             remove    dynamic-value" title="remove {{.first-name}} {{.last-name}}."></button
							><button class="fa fa-arrow-circle-down move-down dynamic-value"></button
							><button class="fa fa-arrow-circle-up   move-up   dynamic-value"></button>
					</div>
				</div>
			</div>
		</main>

		<footer>
			<p>This framework is developed by Ciber CMS ADM Java Services. Issues and improvements can be sent to <a href="mailto:nl.cms.adm.js@ciber.nl">nl.cms.adm.js@ciber.nl</a>.</p>
			<ul>
				
				<li><a target=_blank href="https://github.com/HaKr/dynamic">GIT</a></li>
				<li><a href="http://www.ciber.nl">COPYRIGHT © 2017 EXPERIS CIBER B.V.</a></li>
			</ul>
		</footer>

		<!-- have some refrence values ready -->
		<input type=hidden name="fte.fulltime= 40 / 40">
		<input type=hidden name="fte.36= 36 / 40">
		<input type=hidden name="fte.32= 32 / 40">
		<input type=hidden name="fte.24= 24 / 40">
		<input type=hidden name="fte.20= 20 / 40">
		<input type=hidden name="fte.16= 16 / 40">

	</body>
</html>
